<!DOCTYPE html>
<html lang="zh" data-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudPaste - åˆ†äº«å†…å®¹</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“‹</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="share.css">
    <!-- ä½¿ç”¨CDNåŠ è½½QRCodeåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- å†…è”å®šä¹‰äºŒç»´ç ç›¸å…³å‡½æ•° -->
    <script>
        function toggleQRCode(url) {
            console.log('ç”ŸæˆäºŒç»´ç ï¼ŒURL:', url);
            
            let container = document.getElementById('qrcode-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'qrcode-container';
                container.className = 'qr-code-container';
                
                const modal = document.createElement('div');
                modal.className = 'qr-code-modal';
                
                const title = document.createElement('h3');
                title.textContent = 'æ‰«æäºŒç»´ç è®¿é—®';
                
                const qrcodeDiv = document.createElement('div');
                qrcodeDiv.id = 'qrcode';
                qrcodeDiv.className = 'qr-code';
                
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'qr-code-actions';
                
                const downloadBtn = document.createElement('button');
                downloadBtn.textContent = 'ä¸‹è½½äºŒç»´ç ';
                downloadBtn.className = 'download-btn';
                downloadBtn.onclick = () => {
                    const canvas = qrcodeDiv.querySelector('canvas');
                    if (canvas) {
                        const link = document.createElement('a');
                        link.download = 'qrcode.png';
                        link.href = canvas.toDataURL('image/png');
                        link.click();
                    }
                };
                
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'å…³é—­';
                closeBtn.className = 'close-btn';
                closeBtn.onclick = () => container.style.display = 'none';
                
                buttonContainer.appendChild(downloadBtn);
                buttonContainer.appendChild(closeBtn);
                
                modal.appendChild(title);
                modal.appendChild(qrcodeDiv);
                modal.appendChild(buttonContainer);
                container.appendChild(modal);
                document.body.appendChild(container);
                
                container.onclick = (e) => {
                    if (e.target === container) {
                        container.style.display = 'none';
                    }
                };
            }
            
            try {
                const qrcodeDiv = document.getElementById('qrcode');
                qrcodeDiv.innerHTML = '';
                
                // åˆ›å»ºQRCodeå®ä¾‹
                const qrcode = new QRCode(qrcodeDiv, {
                    text: url,
                    width: 200,
                    height: 200
                });
                
                // æ˜¾ç¤ºå®¹å™¨
                container.style.display = 'flex';
                
                console.log('äºŒç»´ç ç”ŸæˆæˆåŠŸ');
            } catch (error) {
                console.error('ç”ŸæˆäºŒç»´ç å¤±è´¥:', error);
                alert('ç”ŸæˆäºŒç»´ç å¤±è´¥ï¼Œè¯·ç¨åå†è¯•');
            }
        }
        
        // å…¼å®¹æ—§çš„å‡½æ•°å
        window.toggleQDCode = window.toggleQRCode = toggleQRCode;
        
        // ç¡®ä¿å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸå¯ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼ŒQRCodeçŠ¶æ€:', typeof QRCode);
        });
    </script>
    <!-- æœ€ååŠ è½½å…¶ä»–è„šæœ¬ -->
    <script src="app.js" defer></script>
    <script src="share.js" defer></script>
</head>
<body>
    <header class="header">
        <div class="theme-toggle" id="themeToggle">
            <i class="fas fa-sun"></i>
        </div>
    </header>
    
    <div class="content-container">
        <div class="content-card">
            <div class="card-header">
                <div class="left-actions">
                    <button class="action-btn" id="copyBtn">
                        <i class="fas fa-copy"></i>
                        å¤åˆ¶å†…å®¹
                    </button>
                    <button class="action-btn qr-btn" data-url="" title="æ˜¾ç¤ºäºŒç»´ç ">
                        <i class="fas fa-qrcode"></i>
                        æ˜¾ç¤ºäºŒç»´ç 
                    </button>
                    <button class="action-btn" id="editBtn">
                        <i class="fas fa-edit"></i>
                        ç¼–è¾‘å†…å®¹
                    </button>
                </div>
                <div class="right-actions">
                    <select class="format-select" id="formatSelect">
                        <option value="pdf" selected>PDFæ ¼å¼</option>
                        <option value="png">PNGæ ¼å¼</option>
                    </select>
                    <button class="action-btn" id="downloadBtn">
                        <i class="fas fa-download"></i>
                        å¯¼å‡º
                    </button>
                </div>
            </div>
            
            <div class="card-content">
                <textarea class="share-content" id="shareContent" readonly></textarea>
            </div>
            
            <div class="info-group">
                <span class="info-item">
                    <i class="far fa-clock"></i>
                    åˆ›å»ºæ—¶é—´: <span id="createTime"></span>
                </span>
                <span class="info-item">
                    <i class="far fa-eye"></i>
                    è®¿é—®æ¬¡æ•°: <span id="viewCount">0</span>
                </span>
                <span class="info-item">
                    <i class="fas fa-hourglass-half"></i>
                    è¿‡æœŸæ—¶é—´: <span id="expireTime"></span>
                </span>
            </div>
        </div>

        <!-- Toastæç¤ºå…ƒç´  -->
        <div class="toast" id="toast">
            <i class="fas fa-check-circle"></i>
            <span>å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</span>
        </div>
    </div>
</body>
</html> 